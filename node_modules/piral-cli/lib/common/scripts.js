"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const child_process_1 = require("child_process");
const path_1 = require("path");
const info_1 = require("./info");
function runScript(script, cwd = process.cwd(), output = process.stdout, input = process.stdin) {
    const bin = path_1.resolve('./node_modules/.bin');
    const sep = info_1.isWindows ? ';' : ':';
    const env = Object.assign({}, process.env);
    env.PATH = `${bin}${sep}${env.PATH}`;
    return new Promise((resolve, reject) => {
        const opt = { end: false };
        const cp = child_process_1.exec(script, {
            cwd,
            env,
        });
        cp.stdout.pipe(output, opt);
        input.pipe(cp.stdin, opt);
        cp.stderr.pipe(process.stderr, opt);
        cp.on('error', reject);
        cp.on('close', (code, signal) => (code === 0 ? resolve() : reject(new Error(signal))));
    });
}
exports.runScript = runScript;
//# sourceMappingURL=scripts.js.map